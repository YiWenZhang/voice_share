{% extends "admin/dashboard.html" %}
{% set active_page = 'insights' %}

{% block admin_main %}
<div class="module-header">
  <div class="module-title">
    <h1><i class="ri-history-line" style="color: #10b981;"></i> 听歌行为流水</h1>
    <p>实时追踪全站用户的播放记录与行为 (Limit 100)</p>
  </div>
  <div class="header-status">
    <a href="{{ url_for('db_views.admin_query_center') }}" class="modern-action-btn" style="background: rgba(255,255,255,0.5); border: 1px solid rgba(255,255,255,0.6); padding: 0.6rem 1.2rem; border-radius: 99px; cursor: pointer; color: #475569; font-weight: 600; text-decoration: none; display: flex; align-items: center; gap: 6px; transition: all 0.2s;">
      <i class="ri-arrow-left-line"></i> 返回中心
    </a>
  </div>
</div>

<section class="grid-card">
  <div class="table-scroll">
    <table class="data-table">
      <thead>
        <tr>
          <th style="padding-left: 1.5rem;">时间</th>
          <th>用户</th>
          <th>播放歌曲</th>
          <th>记录ID</th>
        </tr>
      </thead>
      <tbody>
        {% for r in records %}
        <tr>
          <td style="padding-left: 1.5rem; color: #64748b; font-weight: 500;">{{ r.played_at.strftime('%m-%d %H:%M:%S') }}</td>
          <td>
            <span style="font-weight: 700; color: #1e293b;">{{ r.nickname }}</span>
            <span style="color: #94a3b8; font-size: 0.85rem; margin-left: 4px;">(@{{ r.username }})</span>
          </td>
          <td>
            <div style="display: flex; align-items: center; gap: 8px; color: #334155;">
              <div style="width: 24px; height: 24px; background: rgba(139, 92, 246, 0.1); border-radius: 50%; display: flex; align-items: center; justify-content: center; color: #8b5cf6;">
                <i class="ri-disc-line" style="font-size: 0.8rem;"></i>
              </div>
              <span style="font-weight: 600;">{{ r.song_name }}</span>
            </div>
          </td>
          <td style="font-family: monospace; color: #cbd5e1;">#{{ r.id }}</td>
        </tr>
        {% else %}
        <tr><td colspan="4" style="text-align: center; padding: 4rem 0; color: #64748b;">暂无数据</td></tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
</section>
{% endblock %}