{% extends "layout.html" %}
{% block title %}听歌流水{% endblock %}

{% block content %}
<div class="section-wrapper">
  <div class="section-header-modern" style="display: flex; justify-content: space-between; align-items: center;">
    <div>
        <h1><i class="ri-history-line"></i> 用户听歌行为流水</h1>
        <p style="color: #64748b;">实时追踪全站播放记录 (Limit 100)</p>
    </div>
    <a href="{{ url_for('db_views.admin_query_center') }}" class="secondary-btn small">返回中心</a>
  </div>

  <div class="grid-card" style="padding: 0; overflow: hidden;">
      <div class="table-scroll">
        <table class="data-table">
          <thead style="background: #f8fafc;">
            <tr>
              <th style="padding-left: 1.5rem;">时间</th>
              <th>用户</th>
              <th>播放歌曲</th>
              <th>记录ID</th>
            </tr>
          </thead>
          <tbody>
            {% for r in records %}
            <tr>
              <td style="padding-left: 1.5rem; color: #64748b;">{{ r.played_at.strftime('%m-%d %H:%M:%S') }}</td>
              <td>
                  <span style="font-weight: 600;">{{ r.nickname }}</span>
                  <span style="color: #94a3b8; font-size: 0.85rem;">(@{{ r.username }})</span>
              </td>
              <td>
                  <div style="display: flex; align-items: center; gap: 0.5rem; color: #1e293b;">
                      <i class="ri-disc-line" style="color: #8b5cf6;"></i> {{ r.song_name }}
                  </div>
              </td>
              <td style="font-family: monospace; color: #cbd5e1;">#{{ r.id }}</td>
            </tr>
            {% else %}
            <tr><td colspan="4" style="text-align: center; padding: 2rem; color: #94a3b8;">暂无数据</td></tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
  </div>
</div>
{% endblock %}